import{D as d,J as p,S as b,Z as l,a as v,b as f,pb as g,qb as m,rb as y}from"./chunk-PXEZZKWN.js";function q(r,e){let u=!e?.manualCleanup?e?.injector?.get(b)??p(b):null,c=D(e?.equal),t;e?.requireSync?t=l({kind:0},{equal:c}):t=l({kind:1,value:e?.initialValue},{equal:c});let a,i=r.subscribe({next:n=>t.set({kind:1,value:n}),error:n=>{t.set({kind:2,error:n}),a?.()},complete:()=>{a?.()}});if(e?.requireSync&&t().kind===0)throw new d(601,!1);return a=u?.onDestroy(i.unsubscribe.bind(i)),g(()=>{let n=t();switch(n.kind){case 1:return n.value;case 2:throw n.error;case 0:throw new d(601,!1)}},{equal:e?.equal})}function D(r=Object.is){return(e,s)=>e.kind===1&&s.kind===1&&r(e.value,s.value)}function R(r){return m(f(v({},r),{loader:void 0,stream:e=>{let s,u=()=>s?.unsubscribe();e.abortSignal.addEventListener("abort",u);let c=l({value:void 0}),t,a=new Promise(o=>t=o);function i(o){c.set(o),t?.(c),t=void 0}let n=r.stream??r.loader;if(n===void 0)throw new d(990,!1);return s=n(e).subscribe({next:o=>i({value:o}),error:o=>{i({error:y(o)}),e.abortSignal.removeEventListener("abort",u)},complete:()=>{t&&i({error:new d(991,!1)}),e.abortSignal.removeEventListener("abort",u)}}),a}}))}export{q as a,R as b};
