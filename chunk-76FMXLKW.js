import{I as a,N as p,W as b,_ as l,a as v,b as f,nb as g,ob as m,pb as y}from"./chunk-BE343B2M.js";function R(r,e){let u=!e?.manualCleanup?e?.injector?.get(b)??p(b):null,c=D(e?.equal),t;e?.requireSync?t=l({kind:0},{equal:c}):t=l({kind:1,value:e?.initialValue},{equal:c});let d,i=r.subscribe({next:n=>t.set({kind:1,value:n}),error:n=>{t.set({kind:2,error:n})},complete:()=>{d?.()}});if(e?.requireSync&&t().kind===0)throw new a(601,!1);return d=u?.onDestroy(i.unsubscribe.bind(i)),g(()=>{let n=t();switch(n.kind){case 1:return n.value;case 2:throw n.error;case 0:throw new a(601,!1)}},{equal:e?.equal})}function D(r=Object.is){return(e,s)=>e.kind===1&&s.kind===1&&r(e.value,s.value)}function q(r){return m(f(v({},r),{loader:void 0,stream:e=>{let s,u=()=>s.unsubscribe();e.abortSignal.addEventListener("abort",u);let c=l({value:void 0}),t,d=new Promise(o=>t=o);function i(o){c.set(o),t?.(c),t=void 0}let n=r.stream??r.loader;if(n===void 0)throw new a(990,!1);return s=n(e).subscribe({next:o=>i({value:o}),error:o=>{i({error:y(o)}),e.abortSignal.removeEventListener("abort",u)},complete:()=>{t&&i({error:new a(991,!1)}),e.abortSignal.removeEventListener("abort",u)}}),d}}))}export{R as a,q as b};
